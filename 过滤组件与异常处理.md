# 一、过滤
过滤作用是筛选出满足条件的数据，比如筛选出用户注册时间在同一天的用户数据等等。Django和drf均没有提供，所以要另外进行安装
```python
pip install django-filter
```
在到`setting.py`中注册到`INSTALLED_APPS`中
```python
INSTALLED_APPS = [
    ...
    'django_filters',  #  注册
]
```
配置过滤组件(全局配置)
```python
REST_FRAMEWORK = {
    ...
    'DEFAULT_FILTER_BACKENDS': ('django_filters.rest_framework.DjangoFilterBackend',)
}
```
**注意**:
1. `APIView`没有包含过滤组件的使用。如果`APIView`需要用到过滤时，要自己定义
2. `GenericAPIView`包含了过滤组件的使用。只要继承了`GenericAPIView`就可以直接使用过滤组件

视图中添加`filter_fields`属性就可以通过接口携带参数的形式进行过滤数据
```python
class BookListView(ListAPIView):

    authentication_classes = []
    permission_classes = []
    throttle_classes = []

    queryset = models.Book.objects.all()
    serializer_class = serializers.BookModelSerializer
    filter_fields = ('title', "price")  # 指定需要过滤字段
```

指定字段过滤: `http://127.0.0.1:8000/app03/books/?title=西游记`

# 二、排序
对于列表数据，`REST framework`提供了`OrderingFilter`过滤器来帮助我们快速指明数据按照指定字段进行排序

在类视图中设置`filter_backends`属性，使用`rest_framework.filters.OrderingFilter`过滤器，`REST framework`会在请求的查询字符串参数中检查是否包含了`ordering`参数，如果包含了`ordering`参数，则按照`ordering`参数指明的排序字段对数据集进行排序。

前端可以传递的`ordering`参数的可选字段值需要在`ordering_fields`中指明
```python
from rest_framework.filters import OrderingFilter
class BookListView(ListAPIView):
    # 认证
    authentication_classes = []
    permission_classes = []
    throttle_classes = []

    queryset = models.Book.objects.all()
    serializer_class = serializers.BookModelSerializer

    # 过滤 OrderingFilter排序过滤器
    filter_backends = [OrderingFilter]
    ordering_fields = ('id', 'price')  # 可以排序的字段 ordering=id升序 ordering=-id表示降序
```
指定字段排序: `http://127.0.0.1:8000/app03/books/?ordering=-price`

过滤以后再次进行排序
```python
from rest_framework.generics import ListAPIView
from rest_framework.filters import OrderingFilter
from django_filters.rest_framework import DjangoFilterBackend


class BookListView(ListAPIView):
    # 认证
    authentication_classes = []
    permission_classes = []
    throttle_classes = []

    queryset = models.Book.objects.all()
    serializer_class = serializers.BookModelSerializer

    # 过滤 OrderingFilter排序过滤器  DjangoFilterBackend指定字段过滤器
    filter_backends = [OrderingFilter, DjangoFilterBackend]  # 局部配置会覆盖全局配置，所以需要将字段过滤主键添加回来
    filter_fields = ('title', "price")  # 可以过滤的字段
    ordering_fields = ('id', 'price')  # 可以排序的字段 ordering=id升序 ordering=-id表示降序
```

先过滤再排序:`http://127.0.0.1:8000/app03/books/?title=西游记&ordering=-price`







